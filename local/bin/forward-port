#!/bin/bash

if [ "$#" -ne 2 ]; then
  echo "Usage: $0 <remote_port> <local_port>"
  exit 1
fi

REMOTE_PORT=$1
LOCAL_PORT=$2

# Validate that ports are numbers
if ! [[ "$REMOTE_PORT" =~ ^[0-9]+$ ]] || ! [[ "$LOCAL_PORT" =~ ^[0-9]+$ ]]; then
  echo "Error: Ports must be integers."
  exit 1
fi

exec socat "TCP6-LISTEN:${REMOTE_PORT},bind=[::],ipv6only=0,fork,reuseaddr" "TCP:localhost:${LOCAL_PORT}"
# exec socat "TCP-LISTEN:${REMOTE_PORT},bind=0.0.0.0,fork,reuseaddr" "TCP:localhost:${LOCAL_PORT}"
